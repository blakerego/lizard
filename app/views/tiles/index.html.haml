.tile_admin
  %h1 Live Tiles

  %ul.sortable.tiles
    - @tiles.each do |tile|
      %li.ui-state-default.live.tile{"data-tile-id" => "#{tile.id}"}
        %h3
          = link_to tile.name, tile
        = link_to 'Edit', edit_tile_path(tile)
        = link_to 'Destroy', tile, :method => :delete, :data => { :confirm => 'Are you sure?' }


  %h1 Top Secret Tiles
  %ul.tiles
    - @secret_tiles.each do |tile|
      %li.tile.secret
        %h3
          = link_to tile.name, tile
        = link_to 'Edit', edit_tile_path(tile)
        = link_to 'Destroy', tile, :method => :delete, :data => { :confirm => 'Are you sure?' }
  %br

  = link_to 'New Tile', new_tile_path


:javascript
  $(function()
  {
    window.TILE_ADMIN = function(){ }

    TILE_ADMIN.prototype = {
      init: function() 
      {
        $('.sortable').sortable(
        {
          update: function(event, ui)
          {
            var ordered = {};
            $.each($('.sortable li'), function(rank, tile)
            {
              ordered[$(tile).data('tile-id')] = rank;
            });

            $.post('/tiles/reorder', {"tiles": ordered});

          }
        });
      }
    }

    var admin = new TILE_ADMIN();
    admin.init();
  })

